module CFDI.Types.STCCID where

import CFDI.Types.Type
import Data.Set (fromList, member)
import Data.Text (Text, pack, unpack)

newtype STCCID = STCCID Text deriving (Eq, Show)

instance Type STCCID where
  parseExpr c
    | c `member` validCodes = Right . STCCID $ pack c
    | otherwise = Left NotInCatalog
    where
      validCodes = fromList
        [ "01", "08", "09", "10", "11", "13", "14", "19", "20", "21", "22"
        , "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33"
        , "34", "35", "36", "37", "38", "39", "40", "41", "42", "44", "45"
        , "46", "48", "011", "012", "013", "014", "015", "019", "084", "086"
        , "091", "098", "101", "102", "103", "104", "105", "106", "107", "108"
        , "109", "111", "112", "131", "132", "141", "142", "144", "145", "147"
        , "149", "191", "192", "193", "194", "195", "196", "199", "201", "202"
        , "203", "204", "205", "206", "207", "208", "209", "211", "212", "213"
        , "214", "221", "222", "223", "224", "225", "227", "228", "229", "231"
        , "233", "235", "237", "238", "239", "241", "242", "243", "244", "249"
        , "251", "253", "254", "259", "261", "262", "263", "264", "265", "266"
        , "271", "272", "273", "274", "276", "277", "278", "279", "281", "282"
        , "283", "284", "285", "286", "287", "289", "291", "295", "299", "301"
        , "302", "303", "304", "306", "307", "311", "312", "313", "314", "315"
        , "316", "319", "321", "322", "324", "325", "326", "327", "328", "329"
        , "331", "332", "333", "335", "336", "339", "341", "342", "343", "344"
        , "345", "346", "348", "349", "351", "352", "353", "354", "355", "356"
        , "357", "358", "359", "361", "362", "363", "364", "365", "366", "367"
        , "369", "371", "372", "373", "374", "375", "376", "379", "381", "382"
        , "383", "384", "385", "386", "387", "391", "393", "394", "395", "396"
        , "399", "401", "402", "411", "412", "421", "422", "423", "441", "451"
        , "461", "462", "0112", "0114", "0115", "0119", "0121", "0122", "0123"
        , "0129", "0131", "0133", "0134", "0139", "0141", "0142", "0143", "0151"
        , "0152", "0191", "0192", "0912", "1031", "1032", "1121", "2011", "2012"
        , "2013", "2014", "2015", "2016", "2017", "2021", "2023", "2024", "2025"
        , "2026", "2031", "2032", "2033", "2034", "2035", "2036", "2037", "2038"
        , "2039", "2041", "2043", "2044", "2045", "2046", "2061", "2062", "2083"
        , "2084", "2086", "2087", "2093", "2094", "2095", "2096", "2097", "2098"
        , "2296", "2297", "2298", "2421", "2429", "2431", "2432", "2491", "2643"
        , "2812", "2813", "2814", "2816", "2818", "2819", "2841", "2871", "2892"
        , "2912", "2951", "2952", "3221", "3251", "3253", "3255", "3259", "3271"
        , "3274", "3275", "3291", "3295", "3312", "3313", "3315", "3331", "3332"
        , "3333", "3334", "3351", "3352", "3357", "3361", "3362", "3391", "3392"
        , "3433", "3441", "3491", "3494", "3524", "3531", "3532", "3533", "3537"
        , "3631", "3632", "3633", "3711", "3712", "3713", "3714", "3715", "3949"
        , "4021", "4022", "4024", "4026", "01131", "01132", "01133", "01134"
        , "01135", "01136", "01137", "01139", "01144", "01193", "01195", "01197"
        , "01221", "01224", "01226", "01232", "01295", "01318", "01334", "01335"
        , "01341", "01342", "01392", "01394", "01398", "01411", "01413", "01414"
        , "01431", "08423", "09131", "10112", "11111", "11112", "14211", "14212"
        , "14219", "14411", "14412", "14413", "14511", "14512", "14514", "14711"
        , "14713", "14714", "14715", "14716", "14911", "14913", "14914", "20141"
        , "20411", "20412", "20421", "20423", "20461", "20462", "20463", "20471"
        , "20472", "20611", "20616", "20617", "20625", "20626", "20821", "20823"
        , "20851", "20859", "20911", "20914", "20921", "20923", "24114", "24115"
        , "24116", "24212", "26111", "26211", "26212", "26213", "26214", "26217"
        , "26218", "26471", "26613", "28123", "28184", "28193", "28212", "28213"
        , "28991", "29111", "29112", "29113", "29114", "29115", "29116", "29117"
        , "29119", "29911", "29913", "29914", "32411", "32511", "32594", "33111"
        , "33112", "33119", "33121", "33211", "34411", "37111", "37112", "37113"
        , "37147", "37422", "40211", "41111", "41114", "41115"
        ]

  render (STCCID x) = unpack x
